<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Popis pitanja</title>
  <link rel="stylesheet" href="/css/admin/questions.css">
  <script src="/js/admin/questions.js" defer></script>
</head>
<body>
  <%- include('../../partials/header') %>
  <%- include('../../partials/messaging') %>
  <div class="search-filter-container">
    <input type="text" id="searchInput" placeholder="PretraÅ¾i po tekstu..." value="<%= search || '' %>">
    <select id="filterSelect">
      <option value="" <%= !filter ? 'selected' : '' %>>Sve kategorije</option>
      <% (categories || []).forEach(category => { %>
        <option value="<%= category %>" <%= filter === category ? 'selected' : '' %>><%= category %></option>

      <% }); %>
    </select>
  </div>

  <h1>Neprovjerena pitanja</h1>
  <% if (pendingQuestions.length === 0) { %>
    <p class="no-questions">Nema neprovjerenih pitanja.</p>
  <% } else { %>
    <div class="pending-questions-grid">
      <% pendingQuestions.forEach(question => { %>
        <a href="/admin/questions/<%= question._id %>/" class="question-box">
          <h2><%= question.text %></h2>
          <% if (question.image && question.image !== "") { %>
            <img src="<%= question.image %>" alt="Question image">
          <% } %>
          <p><strong>Kategorija:</strong> <%= question.category %></p>
          <p><strong>HINT: </strong><span style="white-space: pre; font-family: monospace;"><%= question.hint.replace(/\u00a0/g, ' ') %></span></p>
          <p><strong>Odgovor 1:</strong> <%= question.answers[0] %></p>
          <p><strong>Odgovor 2:</strong> <%= question.answers[1] %></p>
          <p><strong>Odgovor 3:</strong> <%= question.answers[2] %></p>
          <p><strong>Odgovor 4:</strong> <%= question.answers[3] %></p>
          <p><strong>Status:</strong> <%= question.status.toUpperCase() %></p>
        </a>
      <% }); %>
    </div>

    <div class="pagination">
      <% if (pendingPage > 1) { %>
        <a href="?pendingPage=<%= pendingPage - 1 %>&approvedPage=<%= approvedPage %><%= search ? '&search=' + encodeURIComponent(search) : '' %><%= filter ? '&filter=' + encodeURIComponent(filter) : '' %>">Prethodno</a>
      <% } %>
      <% for (let i = 1; i <= totalPendingPages; i++) { %>
        <a href="?pendingPage=<%= i %>&approvedPage=<%= approvedPage %><%= search ? '&search=' + encodeURIComponent(search) : '' %><%= filter ? '&filter=' + encodeURIComponent(filter) : '' %>" <%= i === pendingPage ? 'class="active"' : '' %>><%= i %></a>
      <% } %>
      <% if (pendingPage < totalPendingPages) { %>
        <a href="?pendingPage=<%= pendingPage + 1 %>&approvedPage=<%= approvedPage %><%= search ? '&search=' + encodeURIComponent(search) : '' %><%= filter ? '&filter=' + encodeURIComponent(filter) : '' %>">Dalje</a>
      <% } %>
    </div>
  <% } %>

  <h1>Odobrena pitanja</h1>
  <% if (approvedQuestions.length === 0) { %>
    <p class="no-questions">Nema odobrenih pitanja.</p>
  <% } else { %>
    <div class="approved-questions-grid">
      <% approvedQuestions.forEach(question => { %>
        <a href="/admin/questions/<%= question._id %>/" class="question-card">
          <h2><%= question.text %></h2>
        </a>
      <% }); %>
    </div>

    <div class="pagination">
      <% if (approvedPage > 1) { %>
        <a href="?pendingPage=<%= pendingPage %>&approvedPage=<%= approvedPage - 1 %><%= search ? '&search=' + encodeURIComponent(search) : '' %><%= filter ? '&filter=' + encodeURIComponent(filter) : '' %>">Prethodno</a>
      <% } %>
      <% for (let i = 1; i <= totalApprovedPages; i++) { %>
        <a href="?pendingPage=<%= pendingPage %>&approvedPage=<%= i %><%= search ? '&search=' + encodeURIComponent(search) : '' %><%= filter ? '&filter=' + encodeURIComponent(filter) : '' %>" <%= i === approvedPage ? 'class="active"' : '' %>><%= i %></a>
      <% } %>
      <% if (approvedPage < totalApprovedPages) { %>
        <a href="?pendingPage=<%= pendingPage %>&approvedPage=<%= approvedPage + 1 %><%= search ? '&search=' + encodeURIComponent(search) : '' %><%= filter ? '&filter=' + encodeURIComponent(filter) : '' %>">Dalje</a>
      <% } %>
    </div>
  <% } %>
</body>
</html>