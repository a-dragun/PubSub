<!DOCTYPE html>
<html lang="en">

<head>
    <title>Popis prijava</title>
    <style>
        :root {
            --bg: #B0D9E9;
            --accent: #748CAB;
            --light: #ffffffcc;
            --text: #4C5B66;
            --beige: #EAD7BB;
            --status-pending: #ff4b4b;
            --status-resolved: #28a745;
        }

        body {
            margin: 0;
            margin-top: 60px;
            font-family: sans-serif;
            background: linear-gradient(-45deg, var(--bg), var(--beige), #a2d2ee, #F4EAE0);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            min-height: 100vh;
            color: var(--text);
            padding: 2rem;
        }

        @keyframes gradient {
            0% {
                background-position: 0% 50%;
            }

            50% {
                background-position: 100% 50%;
            }

            100% {
                background-position: 0% 50%;
            }
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin: 1rem 0 2rem;
            color: var(--text);
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .report-box {
            background: var(--light);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-decoration: none;
            color: var(--text);
            display: block;
            border-left: 5px solid;
        }

        .report-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
        }

        .reported-user {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.25rem;
            margin: 0 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(116, 140, 171, 0.3);
            color: var(--accent);
        }

        .message-preview {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .message-detail {
            font-size: 0.95rem;
            font-style: italic;
            color: var(--text);
            margin-top: 5px;
            opacity: 0.8;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .report-meta {
            font-size: 0.85rem;
            color: var(--accent);
            margin-top: 1rem;
            padding-top: 0.5rem;
            border-top: 1px dashed rgba(116, 140, 171, 0.2);
            display: flex;
            justify-content: space-between;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.75em;
            text-transform: uppercase;
            color: white;
        }

        .status-pending {
            background-color: var(--status-pending);
        }

        .status-resolved {
            background-color: var(--status-resolved);
        }

        .report-meta span strong {
            font-weight: 600;
            color: var(--text);
        }

        .no-reports {
            text-align: center;
        }
    </style>
</head>

<body>
      <%- include('../../partials/header') %>
  <%- include('../../partials/messaging') %>

        <h1>Popis prijava</h1>

        <div class="grid-container">
            <% if (reports.length==0) { %>
                <p class="no-reports">Nema prijavljenih poruka!</p>
                <% } %>
                    <% reports.forEach(report=> { %>
                        <% const reportedName=report.reportedUsername; const authorName=report.authorUsername; const
                            dateOptions={ year: 'numeric' , month: 'short' , day: 'numeric' , hour: '2-digit' ,
                            minute: '2-digit' }; const formattedDate=new
                            Date(report.createdAt).toLocaleDateString('hr-HR', dateOptions); const status=report.status
                            || 'pending' ; const statusClass='status-' + status; let borderColor='var(--status-pending)'
                            ; if (status==='resolved' ) borderColor='var(--status-resolved)' ; %>

                            <a href="/admin/reports/<%= report._id %>" class="report-box">
                                <div class="reported-user">
                                    <span>Prijavljen: <strong>
                                            <%= reportedName %>
                                        </strong></span>
                                    <div>
                                        <% if (report.reportType==='comment' ) { %>
                                            <span class="status-badge"
                                                style="background-color: #6c757d; margin-right: 5px;">Komentar</span>
                                            <% } else if (report.reportType==='chat' ) { %>
                                                <span class="status-badge"
                                                    style="background-color: #007bff; margin-right: 5px;">Poruka</span>
                                                <% } %>
                                                    <span class="status-badge <%= statusClass %>">
                                                        <%= status %>
                                                    </span>
                                    </div>
                                </div>

                                <div class="message-preview">
                                    Razlog: <%= report.reason %>
                                </div>

                                <div class="message-detail">
                                    Poruka: "<%= report.reportedMessage %>"
                                </div>

                                <div class="report-meta">
                                    <span>Prijavio: <strong>
                                            <%= authorName %>
                                        </strong></span>
                                    <span>
                                        <%= formattedDate %>
                                    </span>
                                </div>
                            </a>
                            <% }); %>

        </div>
</body>

</html>